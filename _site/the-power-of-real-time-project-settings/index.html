<!doctype html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>My Blog</title>
</head>
<body>
<h1></h1>

<p>Did you know there are customizable server/client configuration values within your Exceptionless Project’s settings? Well <strong>now you do</strong> – and knowing’s half the battle!</p>
<p>These project level settings are a dictionary of key value pairs (string key, string value). They are defined server-side and automatically pushed to the client when they are updated. Using this feature allows you to control what you send without redeploying your app, which we think is pretty cool!<!--more--></p>
<p><strong>You can use these client configuration settings for a variety of applications, including:</strong></p>
<ul>
<li>Controlling <a href="http://docs.exceptionless.com/contents/security/" target="_blank">data exclusions</a> for protecting sensitive information</li>
<li>Enabling / Disabling user signups</li>
<li>Turning logging on or off</li>
<li>Enabling analytics</li>
<li>Controlling information collection</li>
<li>And many more! You can send any key value pair to control whatever you like within your app.</li>
</ul>
<p>Let’s take a look at a JavaScript and .NET client usage example to get your rolling with this feature.</p>
<h2>Adding a New Client Configuration Value</h2>
<p><a href="http://exceptionless.com/assets/project-settings-page.png"><img loading="lazy" class="alignright wp-image-13327 size-medium" style="margin-left: 15px; margin-bottom: 15px;" src="http://exceptionless.com/assets/project-settings-page-300x209.png" alt="Exceptionless Client Configuration Settings" width="300" height="209" data-id="13327" srcset="https://exceptionless.com/assets/project-settings-page-300x209.png 300w, https://exceptionless.com/assets/project-settings-page.png 813w" sizes="(max-width: 300px) 100vw, 300px" /></a></p>
<p>Before we get started with more of an explanation and an example, we need to add a new key and value. To do so, we go to <code>Admin &gt; Projects</code> in our Exceptionless Dashboard, select the project we are working on, then go to the “Settings” tab.</p>
<p>This is where we can add a “New Client Configuration,” which simply consists of the key and value. For the example below, we’ll add the (fictional) <code>enableLogSubmission</code> key and set it to <code>true</code>.</p>
<h2>How it Works</h2>
<p>When your application first starts up, your project’s client configuration settings are read (from storage) and applied.</p>
<p>If a setting value doesn’t exist in storage, it will be retrieved from the server after the next event submission occurs. We do this by inspecting the response headers and comparing a response header that contains the setting version. If the version doesn’t match the saved setting value then we make a request to get the setting and apply it.</p>
<p><em>It’s worth noting that we allow you to define your own default settings and overwrite them with server side settings, which we’ll include in our example.</em></p>
<h3>How do I use the client configuration settings?</h3>
<p>In the example below, we will dynamically turn on or off the log event submissions at runtime without restarting the app or logging into the server to change configuration settings.</p>
<p><strong>Why, you ask?</strong> Maybe we don’t care about log submission until there is a really tough issue to solve. With Client Configuration Values, we can simply turn it on only when needed.</p>
<p>We’ll assume for this example that we are using the <code>enableLogSubmission</code> key we created above to control this. This setting is made up and doesn’t have to exist server side since we will be providing a default value client side. This allows us to define it via the project settings page at anytime and change our applications behavior.</p>
<p>To control this we will be registering a new <a href="/how-to-add-a-plugin-to-affect-events-in-exceptionless/" target="_blank">client side plugin</a> that runs every time an event is created. If our key (<code>enableLogSubmission</code>) is set to false and the event type is set to log, we will discard the event.</p>
<h3>.NET Example</h3>
<pre class="brush: csharp; title: ; notranslate" title="">ExceptionlessClient.Default.Configuration.AddPlugin("Conditionally cancel log submission", 100, context =&gt; {
    var enableLogSubmission = context.Client.Configuration.Settings.GetBoolean("enableLogSubmission", true);

    // only cancel event submission if it’s a log event and enableLogSubmission is false
    if (context.Event.Type == Event.KnownTypes.Log && !enableLogSubmission) {
        context.Cancel = true;
    }
});
</pre>
<p>You might notice that we are calling the <code>GetBoolean</code> method to check the <code>enableLogSubmission</code> key. This is a helper method that makes it easy to consume saved client configuration values. The first parameter defines the settings key (name). The second parameter is optional and <strong>allows you to set a default value</strong> if the key doesn’t exist in the settings or was unable to be converted to the proper type (e.g., a boolean).</p>
<h4>.NET Helpers</h4>
<p>Above, we used the <code>GetBoolean</code> helper method. In the .NET client, we have a few helpers to convert string configuration values to different system types. These methods also contain overloads that allow you to specify default values.</p>
<p><strong>Helper List</strong></p>
<ul>
<li><code>GetString</code></li>
<li><code>GetBoolean</code></li>
<li><code>GetInt32</code></li>
<li><code>GetInt64</code></li>
<li><code>GetDouble</code></li>
<li><code>GetDateTime</code></li>
<li><code>GetDateTimeOffset</code></li>
<li><code>GetGuid</code></li>
<li><code>GetStringCollection</code> (breaks a comma delimited list into an IEnumerable of strings)</li>
</ul>
<h3>JavaScript Example</h3>
<p>The same functionality above can also be achieved using our new <a href="http://exceptionless.com/javascript-node-js-client-v1-release-notes/">JavaScript Client</a>.</p>
<pre class="brush: jscript; title: ; notranslate" title="">exceptionless.ExceptionlessClient.default.config.addPlugin('Conditionally cancel log submission', 100, function (context, next) {
    var enableLogSubmission = context.client.config.settings['enableLogSubmission'];

    // only cancel event submission if it’s a log event and
    // enableLogSubmission is set to a value and the value is not true.
    if (context.event.type === 'log' && (!!enableLogSubmission && enableLogSubmission !== 'true')) {
       context.cancelled = true;
    }

    next();
});
</pre>
<h2>Subscribing to Setting Changes</h2>
<p>If you would like to be notified when client configuration settings are changed, you can subscribe to them using something like the below code. This is useful when you want to update your application in real time when settings change server side.</p>
<h3>.NET</h3>
<pre class="brush: csharp; title: ; notranslate" title="">ExceptionlessClient.Default.Configuration.Settings.Changed += SettingsOnChanged;

private void SettingsOnChanged(object sender, ChangedEventArgs&lt;KeyValuePair&lt;string, string&gt;&gt; args) {
   Console.WriteLine("The key {0} was {1}", args.Item.Key, args.Action);
}
</pre>
<h3>JavaScript</h3>
<pre class="brush: jscript; title: ; notranslate" title="">exceptionless.SettingsManager.onChanged(function(configuration)  {
   // configuration.settings contains the new settings
});
</pre>
<h2>Any Questions?</h2>
<p>These Client Configuration Values are somewhat of a hidden Exceptionless gem, but we think they are power and that many of our users can find real value in using them to control the flow of information, specifically sensitive data.</p>
<p>If you have any questions or comments, please let us know. As usual, we’re all ears!</p>

</body>
</html>
